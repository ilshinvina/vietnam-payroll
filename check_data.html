<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°ì´í„° í™•ì¸</title>
    <style>
        body {
            font-family: 'Malgun Gothic', monospace;
            padding: 20px;
            background: #f5f5f5;
        }
        .section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h2 {
            color: #667eea;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        pre {
            background: #f8f8f8;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.9em;
        }
        .highlight {
            background: yellow;
            font-weight: bold;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            margin: 5px;
        }
        button:hover {
            background: #5568d3;
        }
        .error {
            color: red;
            font-weight: bold;
        }
        .success {
            color: green;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>ğŸ” localStorage ë°ì´í„° í™•ì¸</h1>

    <div class="section">
        <h2>1ï¸âƒ£ ì „ì²´ ì§ì› ìˆ˜ (vietnamPayrollEmployees)</h2>
        <div id="employeesData"></div>
    </div>

    <div class="section">
        <h2>2ï¸âƒ£ 2025ë…„ 11ì›” ê¸‰ì—¬ ë°ì´í„° (payrollHistory_2025_11)</h2>
        <div id="nov2025Data"></div>
    </div>

    <div class="section">
        <h2>3ï¸âƒ£ 2025ë…„ 12ì›” ê¸‰ì—¬ ë°ì´í„° (payrollHistory_2025_12)</h2>
        <div id="dec2025Data"></div>
    </div>

    <div class="section">
        <h2>4ï¸âƒ£ ê¸‰ì—¬ ì´ë ¥ ëª©ë¡ (payrollHistoryList)</h2>
        <div id="historyListData"></div>
    </div>

    <div class="section">
        <h2>5ï¸âƒ£ localStorage ì „ì²´ í‚¤ ëª©ë¡</h2>
        <div id="allKeysData"></div>
    </div>

    <div class="section">
        <h2>ğŸ”§ ë°ì´í„° ì •ë¦¬</h2>
        <button onclick="clearAllPayrollData()">âš ï¸ ê¸‰ì—¬ ë°ì´í„° ì™„ì „ ì‚­ì œ</button>
        <button onclick="clearAllLocalStorage()">ğŸš¨ localStorage ì „ì²´ ì‚­ì œ (íšŒì‚¬ í”„ë¡œí•„ í¬í•¨)</button>
        <button onclick="clearNovemberData()">11ì›” ë°ì´í„°ë§Œ ì‚­ì œ</button>
        <button onclick="clearDecemberData()">12ì›” ë°ì´í„°ë§Œ ì‚­ì œ</button>
        <button onclick="location.reload()">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
    </div>

    <script>
        function checkEmployees() {
            const employees = JSON.parse(localStorage.getItem('vietnamPayrollEmployees') || '{}');
            const count = Object.keys(employees).length;

            let html = `<p><span class="highlight">ì´ ì§ì› ìˆ˜: ${count}ëª…</span></p>`;
            html += '<pre>' + JSON.stringify(employees, null, 2) + '</pre>';

            document.getElementById('employeesData').innerHTML = html;
        }

        function checkNovember2025() {
            const key = 'payrollHistory_2025_11';
            const data = JSON.parse(localStorage.getItem(key) || '{}');

            let html = '';
            if (data.data && data.data.length > 0) {
                html += `<p><span class="success">âœ“ ë°ì´í„° ìˆìŒ</span></p>`;
                html += `<p>ì €ì¥ëœ ì§ì› ìˆ˜: ${data.data.length}ëª…</p>`;
                html += `<p>í™•ì •ëœ ì§ì›: ${(data.confirmedEmployees || []).length}ëª…</p>`;
                html += `<p>í™•ì • ì§ì› ID: ${JSON.stringify(data.confirmedEmployees || [])}</p>`;
                html += '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            } else {
                html += `<p><span class="error">âœ— ë°ì´í„° ì—†ìŒ</span></p>`;
            }

            document.getElementById('nov2025Data').innerHTML = html;
        }

        function checkDecember2025() {
            const key = 'payrollHistory_2025_12';
            const data = JSON.parse(localStorage.getItem(key) || '{}');

            let html = '';
            if (data.data && data.data.length > 0) {
                html += `<p><span class="success">âœ“ ë°ì´í„° ìˆìŒ</span></p>`;
                html += `<p>ì €ì¥ëœ ì§ì› ìˆ˜: ${data.data.length}ëª…</p>`;
                html += `<p>í™•ì •ëœ ì§ì›: ${(data.confirmedEmployees || []).length}ëª…</p>`;
                html += `<p>í™•ì • ì§ì› ID: ${JSON.stringify(data.confirmedEmployees || [])}</p>`;
                html += '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            } else {
                html += `<p><span class="error">âœ— ë°ì´í„° ì—†ìŒ</span></p>`;
            }

            document.getElementById('dec2025Data').innerHTML = html;
        }

        function checkHistoryList() {
            const list = JSON.parse(localStorage.getItem('payrollHistoryList') || '[]');

            let html = `<p>ë“±ë¡ëœ ê¸‰ì—¬ ì´ë ¥: ${list.length}ê°œ</p>`;
            html += '<pre>' + JSON.stringify(list, null, 2) + '</pre>';

            document.getElementById('historyListData').innerHTML = html;
        }

        function checkAllKeys() {
            let html = '<p><strong>localStorageì— ì €ì¥ëœ ëª¨ë“  í‚¤:</strong></p>';
            html += '<ul style="list-style: none; padding: 0;">';

            const keys = Object.keys(localStorage);
            html += `<p>ì´ ${keys.length}ê°œì˜ í‚¤ê°€ ìˆìŠµë‹ˆë‹¤.</p>`;

            keys.sort().forEach(key => {
                const value = localStorage.getItem(key);
                const size = new Blob([value]).size;
                html += `<li style="padding: 5px; border-bottom: 1px solid #eee;">`;
                html += `<strong>${key}</strong>`;
                html += ` <span style="color: #999;">(${(size/1024).toFixed(2)} KB)</span>`;
                html += `</li>`;
            });

            html += '</ul>';
            document.getElementById('allKeysData').innerHTML = html;
        }

        function clearAllPayrollData() {
            if (confirm('âš ï¸ ì •ë§ë¡œ ëª¨ë“  ê¸‰ì—¬ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì§ì› ì •ë³´ì™€ ê¸‰ì—¬ ì´ë ¥ì´ ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤!')) {
                let deletedCount = 0;

                // ì§ì› ë°ì´í„° ì‚­ì œ
                localStorage.removeItem('vietnamPayrollEmployees');
                deletedCount++;

                // ê¸‰ì—¬ ì´ë ¥ ì‚­ì œ
                for (let year = 2024; year <= 2026; year++) {
                    for (let month = 1; month <= 12; month++) {
                        const key1 = `payrollHistory_${year}_${month}`;
                        const key2 = `payrollConfirmed_${year}_${month}`;
                        if (localStorage.getItem(key1)) {
                            localStorage.removeItem(key1);
                            deletedCount++;
                        }
                        if (localStorage.getItem(key2)) {
                            localStorage.removeItem(key2);
                            deletedCount++;
                        }
                    }
                }

                // ê¸‰ì—¬ ì´ë ¥ ëª©ë¡
                if (localStorage.getItem('payrollHistoryList')) {
                    localStorage.removeItem('payrollHistoryList');
                    deletedCount++;
                }

                alert(`âœ… ${deletedCount}ê°œì˜ ê¸‰ì—¬ ê´€ë ¨ ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!\n\níšŒì‚¬ í”„ë¡œí•„ì€ ìœ ì§€ë©ë‹ˆë‹¤.`);
                location.reload();
            }
        }

        function clearAllLocalStorage() {
            if (confirm('ğŸš¨ ê²½ê³ ! localStorageë¥¼ ì™„ì „íˆ ë¹„ì›ë‹ˆë‹¤!\n\níšŒì‚¬ í”„ë¡œí•„, ì§ì›, ê¸‰ì—¬ ë°ì´í„°ê°€ ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤!\n\nì •ë§ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                if (confirm('ì •ë§ ì •ë§ í™•ì‹¤í•©ë‹ˆê¹Œ? ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤!')) {
                    const count = localStorage.length;
                    localStorage.clear();
                    alert(`âœ… ${count}ê°œì˜ ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!`);
                    location.reload();
                }
            }
        }

        function clearNovemberData() {
            if (confirm('11ì›” ê¸‰ì—¬ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                localStorage.removeItem('payrollHistory_2025_11');
                localStorage.removeItem('payrollConfirmed_2025_11');

                // payrollHistoryListì—ì„œë„ ì œê±°
                const list = JSON.parse(localStorage.getItem('payrollHistoryList') || '[]');
                const newList = list.filter(h => !(h.year === 2025 && h.month === 11));
                localStorage.setItem('payrollHistoryList', JSON.stringify(newList));

                alert('âœ… 11ì›” ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!');
                location.reload();
            }
        }

        function clearDecemberData() {
            if (confirm('12ì›” ê¸‰ì—¬ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                localStorage.removeItem('payrollHistory_2025_12');
                localStorage.removeItem('payrollConfirmed_2025_12');

                // payrollHistoryListì—ì„œë„ ì œê±°
                const list = JSON.parse(localStorage.getItem('payrollHistoryList') || '[]');
                const newList = list.filter(h => !(h.year === 2025 && h.month === 12));
                localStorage.setItem('payrollHistoryList', JSON.stringify(newList));

                alert('âœ… 12ì›” ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!');
                location.reload();
            }
        }

        // í˜ì´ì§€ ë¡œë“œì‹œ ëª¨ë“  ë°ì´í„° í™•ì¸
        window.onload = function() {
            checkEmployees();
            checkNovember2025();
            checkDecember2025();
            checkHistoryList();
            checkAllKeys();

            // ìš”ì•½ ì •ë³´ í‘œì‹œ
            const employees = JSON.parse(localStorage.getItem('vietnamPayrollEmployees') || '{}');
            const nov = JSON.parse(localStorage.getItem('payrollHistory_2025_11') || '{}');
            const dec = JSON.parse(localStorage.getItem('payrollHistory_2025_12') || '{}');

            console.log('=== ë°ì´í„° ìš”ì•½ ===');
            console.log('ì „ì²´ ì§ì›:', Object.keys(employees).length, 'ëª…');
            console.log('11ì›” í™•ì •:', (nov.confirmedEmployees || []).length, 'ëª…');
            console.log('12ì›” í™•ì •:', (dec.confirmedEmployees || []).length, 'ëª…');
        };
    </script>
</body>
</html>

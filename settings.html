<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„¤ì • - ë² íŠ¸ë‚¨ ê¸‰ì—¬ ê´€ë¦¬ ì‹œìŠ¤í…œ</title>

    <!-- JavaScript ë¨¼ì € ë¡œë“œ -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="data-manager.js" defer></script>
    <script src="excel-template.js?v=20251206_fix2" defer></script>
    <script src="settings.js?v=20251207" defer></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px 40px;
            border-radius: 20px 20px 0 0;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
        }

        .company-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        .company-logo {
            max-width: 100px;
            max-height: 100px;
            object-fit: contain;
        }

        .company-info {
            text-align: left;
        }

        .company-name {
            font-size: 1.4em;
            color: #1a1a1a;
            font-weight: 900;
            margin-bottom: 5px;
            letter-spacing: -0.5px;
        }

        .company-address {
            font-size: 1em;
            color: #444;
            font-weight: 600;
            line-height: 1.6;
            white-space: pre-line;
            word-wrap: break-word;
            max-width: 600px;
        }

        .header h1 {
            font-size: 2em;
            color: #667eea;
        }

        .btn-home {
            padding: 12px 24px;
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
            border-radius: 8px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s;
        }

        .btn-home:hover {
            background: #667eea;
            color: white;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #ddd;
        }

        .tab {
            flex: 1;
            padding: 20px 10px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: transparent;
            font-size: 1.1em;
            font-weight: bold;
            color: #666;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }

        .tab:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .content {
            background: white;
            padding: 40px;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            min-height: 500px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* ì§ì› ê´€ë¦¬ */
        .employee-list {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .employee-item {
            background: white;
            padding: 25px;
            margin: 15px 0;
            border-radius: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 5px solid #667eea;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.15);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        .employee-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 0;
            pointer-events: none;
        }

        .employee-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.25);
        }

        .employee-item:hover::before {
            opacity: 1;
        }

        .employee-info {
            flex: 1;
            position: relative;
            z-index: 1;
        }

        .employee-name {
            font-weight: bold;
            font-size: 1.3em;
            color: #333;
            margin-bottom: 8px;
        }

        .employee-details {
            color: #666;
            font-size: 1em;
        }

        .employee-actions {
            display: flex;
            gap: 10px;
            position: relative;
            z-index: 1;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-edit {
            background: #2196f3;
            color: white;
        }

        .btn-edit:hover {
            background: #1976d2;
        }

        .btn-delete {
            background: #f44336;
            color: white;
        }

        .btn-delete:hover {
            background: #d32f2f;
        }

        .btn-success {
            background: #4caf50;
            color: white;
        }

        .btn-success:hover {
            background: #45a049;
        }

        /* íšŒì‚¬ ì„¤ì • */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-top: 20px;
        }

        .setting-item {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .setting-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.2);
            border-color: rgba(102, 126, 234, 0.3);
        }

        .setting-item label {
            display: block;
            font-weight: bold;
            margin-bottom: 12px;
            color: #667eea;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .setting-item label::before {
            content: 'â—';
            color: #667eea;
            font-size: 0.6em;
        }

        .setting-item input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1.1em;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        .setting-item input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
            background: white;
            transform: scale(1.02);
        }

        /* ê³µíœ´ì¼ ì„¤ì • */
        .holiday-preset {
            background: white;
            padding: 25px;
            margin: 20px 0;
            border-radius: 15px;
            cursor: pointer;
            border-left: 5px solid #ff9800;
            box-shadow: 0 5px 20px rgba(255, 152, 0, 0.15);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            overflow: hidden;
        }

        .holiday-preset::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.05) 0%, rgba(251, 140, 0, 0.05) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .holiday-preset:hover {
            background: white;
            transform: translateX(10px) scale(1.02);
            box-shadow: 0 10px 35px rgba(255, 152, 0, 0.3);
        }

        .holiday-preset:hover::before {
            opacity: 1;
        }

        .holiday-preset h4 {
            color: #ff9800;
            margin-bottom: 10px;
            font-size: 1.3em;
            position: relative;
        }

        .holiday-preset p {
            color: #666;
            font-size: 1.05em;
            position: relative;
        }

        .action-buttons {
            margin-top: 30px;
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        /* ê¸‰ì—¬ ê·œì • ì¹´ë“œ */
        .payroll-card {
            margin-bottom: 30px;
            padding: 30px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .payroll-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 6px;
            height: 100%;
            background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
        }

        .payroll-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.2);
        }

        .payroll-card:hover::before {
            width: 12px;
        }

        .payroll-card h3 {
            margin-bottom: 20px;
            font-size: 1.5em;
            position: relative;
            padding-bottom: 15px;
        }

        .payroll-card h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 4px;
            background: linear-gradient(90deg, currentColor 0%, transparent 100%);
            border-radius: 2px;
        }

        .info-box {
            padding: 15px 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 12px;
            margin-top: 20px;
            border-left: 4px solid currentColor;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }

        .tax-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 15px;
            overflow: hidden;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .tax-table thead tr {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tax-table th {
            padding: 15px;
            font-weight: bold;
            text-align: center;
            border: none;
        }

        .tax-table td {
            padding: 12px 15px;
            border: 1px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .tax-table tbody tr {
            transition: all 0.3s ease;
        }

        .tax-table tbody tr:hover {
            background: linear-gradient(90deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
            transform: scale(1.01);
        }

        .final-calculation {
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            color: white;
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.4);
            position: relative;
            overflow: hidden;
        }

        .final-calculation::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .final-calculation h3,
        .final-calculation p {
            position: relative;
            z-index: 1;
        }

        @media (max-width: 768px) {
            .tabs {
                flex-wrap: wrap;
            }

            .tab {
                flex: 1 1 45%;
                font-size: 1em;
                padding: 15px 5px;
            }

            .settings-grid {
                grid-template-columns: 1fr;
            }

            .employee-item {
                flex-direction: column;
                gap: 15px;
            }

            .employee-actions {
                width: 100%;
                justify-content: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div>
                <div class="company-header" id="companyHeader">
                    <!-- Company logo and info will be loaded here -->
                </div>
                <h1>âš™ï¸ ì„¤ì •</h1>
            </div>
            <div style="display: flex; align-items: center; gap: 15px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <label style="font-weight: bold; color: #667eea;">ê´€ë¦¬ ì—°ë„:</label>
                    <select id="settingsYear" onchange="changeSettingsYear()" style="padding: 8px 16px; border: 2px solid #667eea; border-radius: 5px; font-size: 1em; font-weight: bold; color: #667eea; cursor: pointer;">
                        <!-- JavaScriptë¡œ ì±„ì›Œì§ -->
                    </select>
                </div>
                <a href="index.html" class="btn-home">ğŸ  í™ˆìœ¼ë¡œ</a>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab(0)">ğŸ‘¥ ì§ì› ê´€ë¦¬</button>
            <button class="tab" onclick="switchTab(1)">ğŸ¢ íšŒì‚¬ ì„¤ì •</button>
            <button class="tab" onclick="switchTab(2)">ğŸ“… ê³µíœ´ì¼ ì„¤ì •</button>
            <button class="tab" onclick="switchTab(3)">ğŸ“‹ ê¸‰ì—¬ ê·œì •</button>
        </div>

        <div class="content">
            <!-- íƒ­ 0: ì§ì› ê´€ë¦¬ -->
            <div id="tab0" class="tab-content active">
                <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                    <button onclick="addEmployee()" class="btn btn-primary" style="flex: 1; min-width: 200px; font-size: 1.1em; padding: 12px 30px;">â• ì§ì› ì¶”ê°€</button>
                    <button onclick="downloadEmployeeTemplate()" style="flex: 1; min-width: 200px; padding: 12px 30px; background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1.1em; box-shadow: 0 4px 10px rgba(255, 152, 0, 0.3);">
                        ğŸ“¥ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
                    </button>
                    <label for="employeeExcelUpload" style="flex: 1; min-width: 200px; padding: 12px 30px; background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1.1em; text-align: center; box-shadow: 0 4px 10px rgba(156, 39, 176, 0.3); display: flex; align-items: center; justify-content: center;">
                        ğŸ“¤ ì—‘ì…€ ë¶ˆëŸ¬ì˜¤ê¸°
                    </label>
                    <input type="file" id="employeeExcelUpload" accept=".xlsx, .xls" onchange="loadEmployeeExcel(event)" style="display: none;">
                    <button onclick="downloadEmployeeData()" style="flex: 1; min-width: 200px; padding: 12px 30px; background: linear-gradient(135deg, #4caf50 0%, #388e3c 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1.1em; box-shadow: 0 4px 10px rgba(76, 175, 80, 0.3);">
                        ğŸ’¾ í˜„ì¬ ì§ì› ë‚´ë³´ë‚´ê¸°
                    </button>
                </div>

                <div style="background: #fff3e0; padding: 15px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #ff9800;">
                    <p style="margin: 0; color: #e65100; font-weight: 600;">ğŸ“Œ ì—‘ì…€ ì‚¬ìš© ê°€ì´ë“œ:</p>
                    <ul style="margin: 10px 0 0 20px; color: #666; line-height: 1.8;">
                        <li><strong>í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ:</strong> ìƒ˜í”Œ ë°ì´í„°ê°€ í¬í•¨ëœ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</li>
                        <li><strong>ì—‘ì…€ ë¶ˆëŸ¬ì˜¤ê¸°:</strong> ì‘ì„±í•œ ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ (ê¸°ì¡´ ì§ì›ì— ì¶”ê°€ë¨)</li>
                        <li><strong>í˜„ì¬ ì§ì› ë‚´ë³´ë‚´ê¸°:</strong> í˜„ì¬ ë“±ë¡ëœ ì§ì› ë°ì´í„°ë¥¼ ì—‘ì…€ë¡œ ë°±ì—…</li>
                        <li><strong>ì…ì‚¬ì¼ í˜•ì‹:</strong> YYYY-MM-DD (ì˜ˆ: 2024-01-15)</li>
                        <li><strong>ì—°ì°¨ì¡°ì •:</strong> ìŒìˆ˜ëŠ” ì´ë¯¸ ì‚¬ìš©, ì–‘ìˆ˜ëŠ” ì¶”ê°€ ì§€ê¸‰</li>
                    </ul>
                </div>

                <div class="employee-list" id="employeeList">
                    <!-- JavaScriptë¡œ ì±„ì›Œì§ -->
                </div>
            </div>

            <!-- íƒ­ 1: íšŒì‚¬ ì„¤ì • -->
            <div id="tab1" class="tab-content">
                <h2 style="color: #667eea; margin-bottom: 20px;">ğŸ’° ê¸‰ì—¬ ê¸°ë³¸ ì„¤ì •</h2>

                <!-- ì‹ëŒ€ ì„¤ì • -->
                <h3 style="color: #764ba2; margin: 20px 0 15px 0; font-size: 1.2em;">ğŸ½ï¸ ì‹ëŒ€ ì„¤ì •</h3>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label>ğŸŒ ì ì‹¬ ì‹ëŒ€ (Ä‘)</label>
                        <input type="number" id="settingLunchMeal" value="25000">
                        <div style="display: flex; align-items: center; gap: 5px; margin-top: 8px;">
                            <input type="text" id="settingLunchTimeStart" value="12:00" placeholder="12:00" style="width: 60px; padding: 5px; border-radius: 4px; border: 1px solid #ddd; text-align: center;">
                            <span>~</span>
                            <input type="text" id="settingLunchTimeEnd" value="13:00" placeholder="13:00" style="width: 60px; padding: 5px; border-radius: 4px; border: 1px solid #ddd; text-align: center;">
                        </div>
                        <small style="color: #999; margin-top: 3px; display: block;">24ì‹œê°„ í˜•ì‹ (ì˜ˆ: 12:00, 23:00)</small>
                    </div>
                    <div class="setting-item">
                        <label>ğŸŒ™ ì €ë… ì‹ëŒ€ (Ä‘)</label>
                        <input type="number" id="settingDinnerMeal" value="25000">
                        <div style="display: flex; align-items: center; gap: 5px; margin-top: 8px;">
                            <input type="text" id="settingDinnerTimeStart" value="22:00" placeholder="22:00" style="width: 60px; padding: 5px; border-radius: 4px; border: 1px solid #ddd; text-align: center;">
                            <span>~</span>
                            <input type="text" id="settingDinnerTimeEnd" value="23:00" placeholder="23:00" style="width: 60px; padding: 5px; border-radius: 4px; border: 1px solid #ddd; text-align: center;">
                        </div>
                        <small style="color: #999; margin-top: 3px; display: block;">24ì‹œê°„ í˜•ì‹ (ì˜ˆ: 18:00, 22:00)</small>
                    </div>
                </div>

                <!-- í‰ì¼ ì‹ëŒ€ ì§€ê¸‰ ì¡°ê±´ -->
                <h3 style="color: #764ba2; margin: 25px 0 15px 0; font-size: 1.1em;">ğŸ“‹ í‰ì¼ ì‹ëŒ€ ì§€ê¸‰ ì¡°ê±´</h3>
                <div class="settings-grid">
                    <div class="setting-item" style="grid-column: 1 / -1;">
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" id="settingWeekdayLunchAuto" checked style="width: 20px; height: 20px; margin-right: 10px; cursor: pointer;">
                            <span>í‰ì¼ ì ì‹¬ ì‹ëŒ€ ìë™ ì§€ê¸‰ (ì¶œê·¼ ì‹œ)</span>
                        </label>
                        <small style="color: #999; margin-top: 5px; display: block;">ì²´í¬ ì‹œ í‰ì¼ ê·¼ë¬´ ì§ì›ì—ê²Œ ìë™ìœ¼ë¡œ ì ì‹¬ ì‹ëŒ€ ì§€ê¸‰</small>
                    </div>
                    <div class="setting-item">
                        <label>í‰ì¼ ì €ë… ì‹ëŒ€ ì§€ê¸‰ ì¡°ê±´</label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span>ì—°ì¥ê·¼ë¬´</span>
                            <input type="number" id="settingWeekdayDinnerHours" value="4" min="0" step="0.5" style="width: 80px; text-align: center;">
                            <span>ì‹œê°„ ì´ìƒ</span>
                        </div>
                        <small style="color: #999; margin-top: 5px; display: block;">ì˜ˆ: 4ì‹œê°„ â†’ ì—°ì¥ê·¼ë¬´ 4ì‹œê°„ ì´ìƒ ì‹œ ì €ë… ì‹ëŒ€ ì§€ê¸‰</small>
                    </div>
                </div>

                <!-- ì¼ìš”ì¼/íœ´ì¼ ì‹ëŒ€ ì§€ê¸‰ ì¡°ê±´ -->
                <h3 style="color: #764ba2; margin: 25px 0 15px 0; font-size: 1.1em;">ğŸŒ ì¼ìš”ì¼/íœ´ì¼ ì‹ëŒ€ ì§€ê¸‰ ì¡°ê±´</h3>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label>ì¼ìš”ì¼ ì ì‹¬ ì‹ëŒ€ ì§€ê¸‰ ì¡°ê±´</label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span>ì´ ê·¼ë¬´ì‹œê°„</span>
                            <input type="number" id="settingSundayLunchHours" value="4" min="0" step="0.5" style="width: 80px; text-align: center;">
                            <span>ì‹œê°„ ì´ìƒ</span>
                        </div>
                        <small style="color: #999; margin-top: 5px; display: block;">ì˜ˆ: 4ì‹œê°„ â†’ ì¼ìš”ì¼ ì´ 4ì‹œê°„ ì´ìƒ ê·¼ë¬´ ì‹œ ì ì‹¬ ì‹ëŒ€ ì§€ê¸‰</small>
                    </div>
                    <div class="setting-item">
                        <label>ì¼ìš”ì¼ ì €ë… ì‹ëŒ€ ì§€ê¸‰ ì¡°ê±´</label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span>ì´ ê·¼ë¬´ì‹œê°„</span>
                            <input type="number" id="settingSundayDinnerHours" value="12" min="0" step="0.5" style="width: 80px; text-align: center;">
                            <span>ì‹œê°„ ì´ìƒ</span>
                        </div>
                        <small style="color: #999; margin-top: 5px; display: block;">ì˜ˆ: 12ì‹œê°„ â†’ ì¼ìš”ì¼ ì´ 12ì‹œê°„ ì´ìƒ ê·¼ë¬´ ì‹œ ì €ë… ì‹ëŒ€ ì§€ê¸‰ (ì •ê·œ 8h + ì—°ì¥ 4h)</small>
                    </div>
                </div>

                <!-- íœ´ê°€ ì‹œ ì ì‹¬ ì‹ëŒ€ ì§€ê¸‰ ì¡°ê±´ -->
                <h3 style="color: #764ba2; margin: 25px 0 15px 0; font-size: 1.1em;">ğŸ–ï¸ íœ´ê°€/ê²°ê·¼ ì‹œ ì ì‹¬ ì‹ëŒ€ ì§€ê¸‰ ì¡°ê±´</h3>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" id="settingAnnualLeaveLunchMeal" style="width: 20px; height: 20px; margin-right: 10px; cursor: pointer;">
                            <span>ğŸ–ï¸ ì—°ì°¨ ì‹œ ì ì‹¬ ì‹ëŒ€ ì§€ê¸‰</span>
                        </label>
                        <small style="color: #999; margin-top: 5px; display: block;">ì²´í¬ ì‹œ ì—°ì°¨ë¥¼ ì‚¬ìš©í•œ ë‚ ì—ë„ ì ì‹¬ ì‹ëŒ€ ì§€ê¸‰</small>
                    </div>
                    <div class="setting-item">
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" id="settingSickLeaveLunchMeal" style="width: 20px; height: 20px; margin-right: 10px; cursor: pointer;">
                            <span>ğŸ¥ ë³‘ê°€ ì‹œ ì ì‹¬ ì‹ëŒ€ ì§€ê¸‰</span>
                        </label>
                        <small style="color: #999; margin-top: 5px; display: block;">ì²´í¬ ì‹œ ë³‘ê°€ë¥¼ ì‚¬ìš©í•œ ë‚ ì—ë„ ì ì‹¬ ì‹ëŒ€ ì§€ê¸‰</small>
                    </div>
                    <div class="setting-item">
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" id="settingExcusedAbsenceLunchMeal" style="width: 20px; height: 20px; margin-right: 10px; cursor: pointer;">
                            <span>ğŸ“ ì‚¬ìœ ê²°ê·¼ ì‹œ ì ì‹¬ ì‹ëŒ€ ì§€ê¸‰</span>
                        </label>
                        <small style="color: #999; margin-top: 5px; display: block;">ì²´í¬ ì‹œ ì‚¬ìœ ê²°ê·¼í•œ ë‚ ì—ë„ ì ì‹¬ ì‹ëŒ€ ì§€ê¸‰</small>
                    </div>
                    <div class="setting-item">
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" id="settingSpecialLeaveLunchMeal" style="width: 20px; height: 20px; margin-right: 10px; cursor: pointer;">
                            <span>ğŸ–¤ ê²½ì¡°ì‚¬ ì‹œ ì ì‹¬ ì‹ëŒ€ ì§€ê¸‰</span>
                        </label>
                        <small style="color: #999; margin-top: 5px; display: block;">ì²´í¬ ì‹œ ê²½ì¡°ì‚¬(ê²°í˜¼/ì¥ë¡€) íœ´ê°€ ì‚¬ìš©í•œ ë‚ ì—ë„ ì ì‹¬ ì‹ëŒ€ ì§€ê¸‰</small>
                    </div>
                </div>
                <div style="margin-top: 10px; padding: 10px; background: #fff3e0; border-radius: 8px; border-left: 4px solid #ff9800;">
                    <small style="color: #e65100;">
                        âš ï¸ <strong>ë¬´ë‹¨ê²°ê·¼</strong>ì€ ì‹ëŒ€ ë¯¸ì§€ê¸‰ (ì„¤ì • ë¶ˆê°€)<br>
                        â€¢ ë¬´ë‹¨ê²°ê·¼: ì‚¬ì „ í†µë³´ ì—†ì´ ê²°ê·¼í•œ ê²½ìš° ì‹ëŒ€ ì§€ê¸‰ ë¶ˆê°€
                    </small>
                </div>

                <!-- ê·¼ë¬´ í˜•íƒœ ì„¤ì • -->
                <h3 style="color: #764ba2; margin: 25px 0 15px 0; font-size: 1.1em;">ğŸŒ™ ì•¼ê°„ ê·¼ë¬´ ì„¤ì •</h3>
                <div class="settings-grid">
                    <div class="setting-item" style="grid-column: 1 / -1;">
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" id="settingNightShiftEnabled" style="width: 20px; height: 20px; margin-right: 10px; cursor: pointer;">
                            <span>ì•¼ê°„ ê·¼ë¬´ ì‚¬ìš© (ë‹¬ë ¥ì— â˜€ï¸/ğŸŒ™ ì „í™˜ ë²„íŠ¼ í‘œì‹œ)</span>
                        </label>
                        <small style="color: #999; margin-top: 5px; display: block;">ì•¼ê°„ì¡°ê°€ ìˆëŠ” ê³µì¥ì—ì„œë§Œ ì²´í¬í•˜ì„¸ìš”.</small>
                    </div>
                </div>

                <!-- ì•¼ê°„ì¡° ì‹œê°„ëŒ€ ì„¤ì • (ì•¼ê°„ ê·¼ë¬´ ì²´í¬ ì‹œ í‘œì‹œ) -->
                <div id="nightShiftTimeSettings" style="display: none; margin-top: 15px; padding: 15px; background: #f3e5f5; border-radius: 10px; border: 2px solid #9c27b0;">
                    <h4 style="color: #7b1fa2; margin: 0 0 15px 0;">â° ì•¼ê°„ì¡° ì‹œê°„ ë¶„ë°° ì„¤ì •</h4>
                    <p style="color: #666; font-size: 0.9em; margin-bottom: 15px;">ì•¼ê°„ì¡°ì˜ ì •ê·œ 8ì‹œê°„ì„ ìš”ìœ¨ë³„ë¡œ ë¶„ë°°í•©ë‹ˆë‹¤. (ì•¼ê·¼ì‹œê°„ì€ ìë™ìœ¼ë¡œ 200%)</p>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div class="setting-item">
                            <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #1565c0;">
                                â˜€ï¸ ì •ê·œ ì‹œê°„ (100%)
                            </label>
                            <div style="display: flex; align-items: center; gap: 5px;">
                                <input type="number" id="settingNightNormalHours" value="4.5" step="0.5" min="0" max="8"
                                    style="width: 80px; padding: 8px; border: 2px solid #1565c0; border-radius: 5px; font-size: 1em; text-align: center;">
                                <span>ì‹œê°„</span>
                            </div>
                            <small style="color: #666; margin-top: 5px; display: block;">ì˜ˆ: 17:30~22:00 = 4.5ì‹œê°„</small>
                        </div>

                        <div class="setting-item">
                            <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #7b1fa2;">
                                ğŸŒ™ ì•¼ê°„ ì‹œê°„ (130%)
                            </label>
                            <div style="display: flex; align-items: center; gap: 5px;">
                                <input type="number" id="settingNightNightHours" value="3.5" step="0.5" min="0" max="8"
                                    style="width: 80px; padding: 8px; border: 2px solid #7b1fa2; border-radius: 5px; font-size: 1em; text-align: center;">
                                <span>ì‹œê°„</span>
                            </div>
                            <small style="color: #666; margin-top: 5px; display: block;">ì˜ˆ: 22:00~02:30 (ì‹ì‚¬ì œì™¸) = 3.5ì‹œê°„</small>
                        </div>
                    </div>

                    <!-- ì•¼ê°„OT ë¹„ìœ¨ ì„¤ì • -->
                    <div style="margin-top: 15px;">
                        <div class="setting-item">
                            <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #c2185b;">
                                ğŸ”¥ ì•¼ê°„+OT ë¹„ìœ¨ ì„¤ì •
                            </label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <select id="settingNightOTRate" style="padding: 10px 15px; border: 2px solid #c2185b; border-radius: 5px; font-size: 1em; background: white;">
                                    <option value="1.5">150% (1.5ë°°)</option>
                                    <option value="1.8">180% (1.8ë°°)</option>
                                    <option value="2.0" selected>200% (2.0ë°°) - ê¸°ë³¸ê°’</option>
                                    <option value="2.5">250% (2.5ë°°)</option>
                                    <option value="3.0">300% (3.0ë°°)</option>
                                </select>
                                <span style="color: #666;">ì•¼ê°„ì¡°ì˜ ì•¼ê·¼ ì‹œê°„ì— ì ìš©</span>
                            </div>
                            <small style="color: #999; margin-top: 5px; display: block;">ë² íŠ¸ë‚¨ ë…¸ë™ë²• ê¸°ì¤€: ì•¼ê°„(22:00~06:00) + ì•¼ê·¼ = ìµœì†Œ 200%</small>
                        </div>
                    </div>

                    <div style="margin-top: 15px; padding: 10px; background: #fff3e0; border-radius: 5px; border-left: 4px solid #ff9800;">
                        <strong style="color: #e65100;">ğŸ“Œ ì•¼ê°„ì¡° ê³„ì‚° ë°©ì‹:</strong>
                        <ul style="margin: 5px 0 0 20px; color: #666; font-size: 0.9em;">
                            <li>ì •ê·œ 8ì‹œê°„ = ìœ„ ì„¤ì •ëŒ€ë¡œ ë¶„ë°° (100% + 130%)</li>
                            <li>ì•¼ê·¼ ì‹œê°„ = ì „ë¶€ <strong style="color: #c2185b;">ì•¼ê°„OT <span id="nightOTRateDisplay">200</span>%</strong> ì ìš©</li>
                        </ul>
                    </div>
                </div>

                <!-- ìˆ˜ë‹¹ ê´€ë¦¬ ì‹œìŠ¤í…œ -->
                <h3 style="color: #764ba2; margin: 25px 0 15px 0; font-size: 1.2em;">ğŸ’µ ìˆ˜ë‹¹ ê´€ë¦¬</h3>
                <p style="color: #666; margin-bottom: 20px; font-size: 0.95em;">íšŒì‚¬ë³„ ìˆ˜ë‹¹ì„ ììœ ë¡­ê²Œ ì¶”ê°€/ìˆ˜ì •í•˜ê³  ë¬´ë‹¨ê²°ê·¼/ì—°ì°¨ ê·œì •ì„ ì„¤ì •í•˜ì„¸ìš”.</p>

                <!-- ìˆ˜ë‹¹ ëª©ë¡ -->
                <div id="allowancesList" style="display: flex; flex-direction: column; gap: 15px; margin-bottom: 20px;">
                    <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                </div>

                <!-- ìˆ˜ë‹¹ ì¶”ê°€ ë²„íŠ¼ -->
                <button onclick="openAllowanceModal()" style="padding: 12px 24px; background: linear-gradient(135deg, #4caf50 0%, #45a049 100%); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1em; transition: all 0.3s;">
                    â• ìˆ˜ë‹¹ ì¶”ê°€
                </button>

                <h2 style="color: #667eea; margin: 30px 0 20px 0;">ğŸ“Š ë³´í—˜ë£Œ ì„¤ì • (%)</h2>
                <p style="color: #999; margin-bottom: 25px; font-size: 0.95em;">ë² íŠ¸ë‚¨ ì •ë¶€ê°€ ì •í•œ ë³´í—˜ë£Œìœ¨ì„ ì„¤ì •í•˜ì„¸ìš”. ë²•ë¥  ë³€ê²½ ì‹œ ì—¬ê¸°ì„œ ìˆ˜ì •í•˜ë©´ ëª¨ë“  ê³„ì‚°ì— ì¦‰ì‹œ ë°˜ì˜ë©ë‹ˆë‹¤.</p>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 25px;">
                    <!-- ê·¼ë¡œì ë¶€ë‹´ -->
                    <div style="border: 3px solid #667eea; border-radius: 15px; padding: 25px; background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);">
                        <h3 style="color: #667eea; margin: 0 0 20px 0; font-size: 1.3em; display: flex; align-items: center; gap: 10px;">
                            ğŸ‘¤ ê·¼ë¡œì ë¶€ë‹´
                        </h3>

                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">ì‚¬íšŒë³´í—˜ (BHXH)</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="number" id="settingEmployeeSocial" value="8" step="0.1" min="0" max="100"
                                       oninput="updateInsuranceTotals()"
                                       style="flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1.1em; text-align: right;">
                                <span style="font-size: 1.2em; font-weight: bold; color: #667eea;">%</span>
                            </div>
                        </div>

                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">ê±´ê°•ë³´í—˜ (BHYT)</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="number" id="settingEmployeeHealth" value="1.5" step="0.1" min="0" max="100"
                                       oninput="updateInsuranceTotals()"
                                       style="flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1.1em; text-align: right;">
                                <span style="font-size: 1.2em; font-weight: bold; color: #667eea;">%</span>
                            </div>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">ì‹¤ì—…ë³´í—˜ (BHTN)</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="number" id="settingEmployeeUnemploy" value="1" step="0.1" min="0" max="100"
                                       oninput="updateInsuranceTotals()"
                                       style="flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1.1em; text-align: right;">
                                <span style="font-size: 1.2em; font-weight: bold; color: #667eea;">%</span>
                            </div>
                        </div>

                        <div style="border-top: 3px solid #667eea; padding-top: 15px; background: white; border-radius: 8px; padding: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span style="font-size: 1.2em; font-weight: bold; color: #333;">ì´ ê·¼ë¡œì ë¶€ë‹´:</span>
                                <span id="employeeTotalRate" style="font-size: 1.5em; font-weight: bold; color: #667eea;">10.5%</span>
                            </div>
                        </div>
                    </div>

                    <!-- íšŒì‚¬ ë¶€ë‹´ -->
                    <div style="border: 3px solid #4caf50; border-radius: 15px; padding: 25px; background: linear-gradient(135deg, rgba(76, 175, 80, 0.05) 0%, rgba(56, 142, 60, 0.05) 100%);">
                        <h3 style="color: #4caf50; margin: 0 0 20px 0; font-size: 1.3em; display: flex; align-items: center; gap: 10px;">
                            ğŸ¢ íšŒì‚¬ ë¶€ë‹´
                        </h3>

                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">ì‚¬íšŒë³´í—˜ (BHXH)</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="number" id="settingCompanySocial" value="17.5" step="0.1" min="0" max="100"
                                       oninput="updateInsuranceTotals()"
                                       style="flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1.1em; text-align: right;">
                                <span style="font-size: 1.2em; font-weight: bold; color: #4caf50;">%</span>
                            </div>
                        </div>

                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">ê±´ê°•ë³´í—˜ (BHYT)</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="number" id="settingCompanyHealth" value="3" step="0.1" min="0" max="100"
                                       oninput="updateInsuranceTotals()"
                                       style="flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1.1em; text-align: right;">
                                <span style="font-size: 1.2em; font-weight: bold; color: #4caf50;">%</span>
                            </div>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">ì‹¤ì—…ë³´í—˜ (BHTN)</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="number" id="settingCompanyUnemploy" value="1" step="0.1" min="0" max="100"
                                       oninput="updateInsuranceTotals()"
                                       style="flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1.1em; text-align: right;">
                                <span style="font-size: 1.2em; font-weight: bold; color: #4caf50;">%</span>
                            </div>
                        </div>

                        <div style="border-top: 3px solid #4caf50; padding-top: 15px; background: white; border-radius: 8px; padding: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span style="font-size: 1.2em; font-weight: bold; color: #333;">ì´ íšŒì‚¬ ë¶€ë‹´:</span>
                                <span id="companyTotalRate" style="font-size: 1.5em; font-weight: bold; color: #4caf50;">21.5%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <script>
                // ë³´í—˜ë£Œìœ¨ í•©ê³„ ìë™ ê³„ì‚°
                function updateInsuranceTotals() {
                    const empSocial = parseFloat(document.getElementById('settingEmployeeSocial').value) || 0;
                    const empHealth = parseFloat(document.getElementById('settingEmployeeHealth').value) || 0;
                    const empUnemploy = parseFloat(document.getElementById('settingEmployeeUnemploy').value) || 0;

                    const compSocial = parseFloat(document.getElementById('settingCompanySocial').value) || 0;
                    const compHealth = parseFloat(document.getElementById('settingCompanyHealth').value) || 0;
                    const compUnemploy = parseFloat(document.getElementById('settingCompanyUnemploy').value) || 0;

                    const empTotal = empSocial + empHealth + empUnemploy;
                    const compTotal = compSocial + compHealth + compUnemploy;

                    document.getElementById('employeeTotalRate').textContent = empTotal.toFixed(1) + '%';
                    document.getElementById('companyTotalRate').textContent = compTotal.toFixed(1) + '%';
                }

                // í˜ì´ì§€ ë¡œë“œ ì‹œ í•©ê³„ ì´ˆê¸°í™”
                if (typeof window !== 'undefined') {
                    window.addEventListener('DOMContentLoaded', function() {
                        updateInsuranceTotals();
                    });
                }
                </script>

                <div class="action-buttons">
                    <button onclick="saveSettings()" class="btn btn-success" style="font-size: 1.1em; padding: 12px 30px;">âœ… ì €ì¥</button>
                </div>
            </div>

            <!-- íƒ­ 2: ê³µíœ´ì¼ ì„¤ì • -->
            <div id="tab2" class="tab-content">
                <h2 style="color: #667eea; margin-bottom: 20px;">ğŸ“… ê³µíœ´ì¼ í”„ë¦¬ì…‹</h2>

                <div class="holiday-preset" onclick="applyHolidayPreset('vietnam2025')">
                    <h4>ğŸ‡»ğŸ‡³ ë² íŠ¸ë‚¨ ê³µíœ´ì¼ 2025</h4>
                    <p>ì„¤ë‚ (1/1, 1/28-31), í†µì¼ê¸°ë…ì¼(4/30), ë…¸ë™ì ˆ(5/1), êµ­ê²½ì¼(9/2)</p>
                </div>

                <div style="margin-top: 30px; padding: 20px; background: #fff3e0; border-radius: 10px; border-left: 4px solid #ff9800;">
                    <h4 style="color: #f57c00; margin-bottom: 10px;">ğŸ’¡ ì‚¬ìš© ë°©ë²•</h4>
                    <p style="color: #666;">
                        ìœ„ì˜ í”„ë¦¬ì…‹ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ì—°ë„ì˜ ê³µíœ´ì¼ì´ ìë™ìœ¼ë¡œ ë“±ë¡ë©ë‹ˆë‹¤.<br>
                        ê°œë³„ ê³µíœ´ì¼ì€ ê¸‰ì—¬ ë“±ë¡ í™”ë©´ì˜ ë‹¬ë ¥ì—ì„œ ë‚ ì§œë¥¼ í´ë¦­í•˜ì—¬ ì¶”ê°€/ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                </div>

                <div class="action-buttons">
                    <button onclick="clearAllHolidays()" class="btn btn-delete" style="font-size: 1.1em; padding: 12px 30px;">ğŸ—‘ï¸ ëª¨ë“  ê³µíœ´ì¼ ì´ˆê¸°í™”</button>
                </div>
            </div>

            <!-- íƒ­ 3: ê¸‰ì—¬ ê·œì • -->
            <div id="tab3" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 style="color: #667eea; margin: 0;">ğŸ“‹ ê¸‰ì—¬ ê³„ì‚° ê·œì •</h2>
                    <span id="ruleYear" style="padding: 8px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 20px; font-weight: bold; font-size: 1.1em;">2025ë…„</span>
                </div>

                <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e8eaf6 100%); padding: 40px; border-radius: 20px; line-height: 1.8;">
                    <!-- 1. ë³´í—˜ë£Œ -->
                    <div class="payroll-card">
                        <h3 style="color: #667eea;">ğŸ’¼ 1. ë³´í—˜ë£Œ</h3>
                        <div style="margin-left: 20px;">
                            <p style="margin-bottom: 10px; font-weight: bold; color: #333;">â–ª ê·¼ë¡œì ë¶€ë‹´:</p>
                            <p style="margin-left: 20px; color: #666;">
                                - ì‚¬íšŒë³´í—˜(BHXH): <span id="info-emp-social" style="color: #667eea; font-weight: bold;">8</span>%<br>
                                - ê±´ê°•ë³´í—˜(BHYT): <span id="info-emp-health" style="color: #667eea; font-weight: bold;">1.5</span>%<br>
                                - ì‹¤ì—…ë³´í—˜(BHTN): <span id="info-emp-unemploy" style="color: #667eea; font-weight: bold;">1</span>%<br>
                                <strong>í•©ê³„: <span id="info-emp-total" style="color: #667eea;">10.5</span>%</strong>
                            </p>
                            <p style="margin: 15px 0 10px 0; font-weight: bold; color: #333;">â–ª íšŒì‚¬ ë¶€ë‹´:</p>
                            <p style="margin-left: 20px; color: #666;">
                                - ì‚¬íšŒë³´í—˜(BHXH): <span id="info-comp-social" style="color: #4caf50; font-weight: bold;">17.5</span>%<br>
                                - ê±´ê°•ë³´í—˜(BHYT): <span id="info-comp-health" style="color: #4caf50; font-weight: bold;">3</span>%<br>
                                - ì‹¤ì—…ë³´í—˜(BHTN): <span id="info-comp-unemploy" style="color: #4caf50; font-weight: bold;">1</span>%<br>
                                <strong>í•©ê³„: <span id="info-comp-total" style="color: #4caf50;">21.5</span>%</strong>
                            </p>
                        </div>
                    </div>

                    <!-- 2. ì‹ëŒ€ -->
                    <div class="payroll-card">
                        <h3 style="color: #ff9800;">ğŸ± 2. ì‹ëŒ€</h3>
                        <div style="margin-left: 20px; color: #666;">
                            <!-- ì‹ëŒ€ ê¸ˆì•¡ ë° ì‹œê°„ -->
                            <p style="margin-bottom: 8px;">ğŸŒ <strong>ì ì‹¬ ì‹ëŒ€</strong>: <span id="info-daily-meal" style="color: #ff9800; font-weight: bold;">25,000</span>Ä‘ (<span id="info-lunch-time" style="color: #1565c0;">12:00~13:00</span>)</p>
                            <p style="margin-bottom: 12px;">ğŸŒ™ <strong>ì €ë… ì‹ëŒ€</strong>: <span id="info-dinner-meal" style="color: #ff9800; font-weight: bold;">25,000</span>Ä‘ (<span id="info-dinner-time" style="color: #4a148c;">22:00~23:00</span>)</p>

                            <!-- ì£¼ê°„ì¡° ì¡°ê±´ -->
                            <div style="background: #e3f2fd; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                                <p style="margin: 0 0 5px 0; font-weight: bold; color: #1565c0;">â˜€ï¸ ì£¼ê°„ì¡°</p>
                                <p style="margin: 0 0 3px 0; font-size: 0.95em;">â–ª ì ì‹¬ ì‹ëŒ€: ì¶œê·¼ ì‹œ ìë™ ì§€ê¸‰</p>
                                <p style="margin: 0; font-size: 0.95em;">â–ª ì €ë… ì‹ëŒ€: ì—°ì¥ê·¼ë¬´ <span id="info-dinner-hours" style="font-weight: bold;">4</span>ì‹œê°„ ì´ìƒ</p>
                            </div>

                            <!-- ì•¼ê°„ì¡° ì¡°ê±´ -->
                            <div id="info-night-shift-meal" style="background: #f3e5f5; padding: 10px; border-radius: 8px; margin-bottom: 10px; display: none;">
                                <p style="margin: 0 0 5px 0; font-weight: bold; color: #7b1fa2;">ğŸŒ™ ì•¼ê°„ì¡°</p>
                                <p style="margin: 0 0 3px 0; font-size: 0.95em;">â–ª ì ì‹¬ ì‹ëŒ€: ë¯¸ì§€ê¸‰ (ê·¼ë¬´ì‹œê°„ ì™¸)</p>
                                <p style="margin: 0; font-size: 0.95em;">â–ª ì €ë… ì‹ëŒ€: ìë™ ì§€ê¸‰ (OT ë¬´ê´€)</p>
                            </div>

                            <!-- ì¼ìš”ì¼ ì¡°ê±´ -->
                            <p style="margin-bottom: 8px;">â–ª ì¼ìš”ì¼ ì ì‹¬ ì‹ëŒ€ (ì´ ê·¼ë¬´ <span id="info-sunday-lunch-hours" style="font-weight: bold;">4</span>ì‹œê°„ ì´ìƒ): <span id="info-sunday-meal" style="color: #ff9800; font-weight: bold;">25,000</span>Ä‘</p>
                            <p style="margin-bottom: 8px;">â–ª ì¼ìš”ì¼ ì €ë… ì‹ëŒ€ (ì´ ê·¼ë¬´ <span id="info-sunday-dinner-hours" style="font-weight: bold;">12</span>ì‹œê°„ ì´ìƒ): <span id="info-sunday-dinner-meal" style="color: #ff9800; font-weight: bold;">25,000</span>Ä‘</p>

                            <div class="info-box" style="border-color: #ff9800;">
                                âš–ï¸ <strong>ë² íŠ¸ë‚¨ ì„¸ë²• (Decree 954/2020/NÄ-CP)</strong><br>
                                ğŸ’¡ ì‹ëŒ€ ë¹„ê³¼ì„¸ í•œë„: <strong style="color: #ff9800;">ì›” 730,000 VND</strong><br>
                                â€» ì´ˆê³¼ë¶„ì€ ê³¼ì„¸ ëŒ€ìƒ ì†Œë“ì— í¬í•¨ë©ë‹ˆë‹¤.
                            </div>
                        </div>
                    </div>

                    <!-- 3. ìˆ˜ë‹¹ -->
                    <div class="payroll-card">
                        <h3 style="color: #4caf50;">ğŸ’° 3. ìˆ˜ë‹¹</h3>
                        <div id="dynamicAllowancesInfo" style="margin-left: 20px; color: #666;">
                            <!-- ë™ì ìœ¼ë¡œ ìˆ˜ë‹¹ ëª©ë¡ ë Œë”ë§ -->
                        </div>
                    </div>

                    <!-- 4. ì‹œê¸‰ ê³„ì‚° ë°©ì‹ -->
                    <div class="payroll-card">
                        <h3 style="color: #9c27b0;">ğŸ§® 4. ì‹œê¸‰ ê³„ì‚° ë°©ì‹</h3>
                        <div style="margin-left: 20px; color: #666;">
                            <div class="info-box" style="border-color: #9c27b0;">
                                âš–ï¸ <strong>ë² íŠ¸ë‚¨ ë…¸ë™ë²• (Labor Code No. 45/2019/QH14)</strong><br>
                                <p style="margin: 10px 0; font-size: 1.2em; color: #333;">
                                    <strong>ì‹œê¸‰</strong> = <strong>ê¸°ë³¸ê¸‰</strong> Ã· (<strong>ì›” í‰ì¼ ìˆ˜</strong> Ã— <strong>8ì‹œê°„</strong>)
                                </p>
                                <p style="margin-top: 10px; color: #666;">
                                    ğŸ’¡ ì›”ë³„ í‰ì¼ ìˆ˜ëŠ” ê³µíœ´ì¼ê³¼ ì¼ìš”ì¼ì„ ì œì™¸í•œ ì‹¤ì œ ê·¼ë¬´ ê°€ëŠ¥ ì¼ìˆ˜ì…ë‹ˆë‹¤.<br>
                                    ì˜ˆì‹œ: 4ì›” (í‰ì¼ 22ì¼) â†’ 7,000,000Ä‘ Ã· (22Ã—8) = 39,772Ä‘/ì‹œê°„<br>
                                    ì˜ˆì‹œ: 5ì›” (í‰ì¼ 26ì¼) â†’ 7,000,000Ä‘ Ã· (26Ã—8) = 33,653Ä‘/ì‹œê°„
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- 5. ì´ˆê³¼ê·¼ë¬´ ìˆ˜ë‹¹ -->
                    <div class="payroll-card">
                        <h3 style="color: #2196f3;">â° 5. ì´ˆê³¼ê·¼ë¬´ ìˆ˜ë‹¹</h3>
                        <div style="margin-left: 20px; color: #666;">
                            <p style="margin-bottom: 8px;">â–ª í‰ì¼ ì—°ì¥ê·¼ë¬´(ì”ì—…): <strong style="color: #2196f3;">ì‹œê¸‰ Ã— 1.5ë°° (150%)</strong></p>
                            <p style="margin-left: 20px; font-size: 0.9em; color: #4caf50; margin-bottom: 10px;">
                                âœ… ì†Œë“ì„¸: <strong>50% ê°€ì‚°ë¶„ ì¤‘ 1/3 ë¹„ê³¼ì„¸</strong>, 2/3 ê³¼ì„¸<br>
                                <span style="color: #999;">â€» Circular 111/2013/TT-BTC ì¤€ìˆ˜</span>
                            </p>

                            <p style="margin-bottom: 8px;">â–ª ì•¼ê°„ê·¼ë¬´ ì¶”ê°€ (22:00~06:00): <strong style="color: #2196f3;">ì‹œê¸‰ Ã— 1.3ë°° (130%)</strong></p>
                            <p style="margin-left: 20px; font-size: 0.9em; color: #4caf50; margin-bottom: 10px;">
                                âœ… ì†Œë“ì„¸: <strong>30% ê°€ì‚°ë¶„ ë¹„ê³¼ì„¸</strong>, ê¸°ë³¸ 100% ê³¼ì„¸<br>
                                <span style="color: #999;">â€» Circular 111/2013/TT-BTC ì¤€ìˆ˜</span>
                            </p>

                            <p style="margin-bottom: 8px;">â–ª ì¼ìš”ì¼ íŠ¹ê·¼: <strong style="color: #2196f3;">ì‹œê¸‰ Ã— 2.0ë°° (200%)</strong></p>
                            <p style="margin-left: 20px; font-size: 0.9em; color: #4caf50; margin-bottom: 10px;">
                                âœ… ì†Œë“ì„¸: <strong>100% ê°€ì‚°ë¶„ ë¹„ê³¼ì„¸</strong>, ê¸°ë³¸ 100% ê³¼ì„¸<br>
                                <span style="color: #999;">â€» Circular 111/2013/TT-BTC ì¤€ìˆ˜</span>
                            </p>

                            <div class="info-box" style="border-color: #2196f3;">
                                ğŸ’¡ <strong>ë¹„ê³¼ì„¸ ìš”ì•½</strong><br>
                                - ì—°ì¥ê·¼ë¬´: 50% ê°€ì‚° â†’ 1/3 ë¹„ê³¼ì„¸ (ì•½ 16.7%)<br>
                                - ì•¼ê°„ê·¼ë¬´: 30% ê°€ì‚° â†’ 30% ë¹„ê³¼ì„¸ (ì•½ 23.1%)<br>
                                - ì¼ìš”ì¼: 100% ê°€ì‚° â†’ 50% ë¹„ê³¼ì„¸
                            </div>
                        </div>
                    </div>

                    <!-- 6. ê°œì¸ì†Œë“ì„¸ -->
                    <div class="payroll-card">
                        <h3 style="color: #9c27b0;">ğŸ“Š 6. ê°œì¸ì†Œë“ì„¸ (ëˆ„ì§„ì„¸ìœ¨)</h3>
                        <div style="margin-left: 20px;">
                            <table class="tax-table">
                                <thead>
                                    <tr>
                                        <th>êµ¬ê°„</th>
                                        <th>ê³¼ì„¸ì†Œë“ (ì›”)</th>
                                        <th>ì„¸ìœ¨</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="text-align: center;">1</td>
                                        <td style="text-align: right;">0 ~ 5,000,000Ä‘</td>
                                        <td style="text-align: center; color: #9c27b0; font-weight: bold;">5%</td>
                                    </tr>
                                    <tr>
                                        <td style="text-align: center;">2</td>
                                        <td style="text-align: right;">5,000,001 ~ 10,000,000Ä‘</td>
                                        <td style="text-align: center; color: #9c27b0; font-weight: bold;">10%</td>
                                    </tr>
                                    <tr>
                                        <td style="text-align: center;">3</td>
                                        <td style="text-align: right;">10,000,001 ~ 18,000,000Ä‘</td>
                                        <td style="text-align: center; color: #9c27b0; font-weight: bold;">15%</td>
                                    </tr>
                                    <tr>
                                        <td style="text-align: center;">4</td>
                                        <td style="text-align: right;">18,000,001 ~ 32,000,000Ä‘</td>
                                        <td style="text-align: center; color: #9c27b0; font-weight: bold;">20%</td>
                                    </tr>
                                    <tr>
                                        <td style="text-align: center;">5</td>
                                        <td style="text-align: right;">32,000,001 ~ 52,000,000Ä‘</td>
                                        <td style="text-align: center; color: #9c27b0; font-weight: bold;">25%</td>
                                    </tr>
                                    <tr>
                                        <td style="text-align: center;">6</td>
                                        <td style="text-align: right;">52,000,001 ~ 80,000,000Ä‘</td>
                                        <td style="text-align: center; color: #9c27b0; font-weight: bold;">30%</td>
                                    </tr>
                                    <tr>
                                        <td style="text-align: center;">7</td>
                                        <td style="text-align: right;">80,000,001Ä‘ ì´ìƒ</td>
                                        <td style="text-align: center; color: #9c27b0; font-weight: bold;">35%</td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="info-box" style="border-color: #9c27b0;">
                                ğŸ’¡ ê°€ì¡± ê³µì œ: ë³¸ì¸ 11,000,000Ä‘ + ë¶€ì–‘ê°€ì¡± 1ì¸ë‹¹ 4,400,000Ä‘
                            </div>
                        </div>
                    </div>

                    <!-- 7. íœ´ê°€ ê·œì • (ë² íŠ¸ë‚¨ ë…¸ë™ë²•) -->
                    <div class="payroll-card">
                        <h3 style="color: #4caf50;">ğŸ–ï¸ 7. íœ´ê°€ ê·œì • (ë² íŠ¸ë‚¨ ë…¸ë™ë²•)</h3>
                        <div style="margin-left: 20px; color: #666;">

                            <!-- ì—°ì°¨ (Annual Leave) -->
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #4caf50; margin-bottom: 10px;">ğŸ“… ì—°ì°¨ íœ´ê°€ (Nghá»‰ phÃ©p nÄƒm) - ì œ113ì¡°</h4>
                                <div style="margin-left: 15px;">
                                    <p style="margin-bottom: 8px;">â–ª <strong>ê¸°ë³¸ ì—°ì°¨</strong>: 12ì¼/ë…„ (12 thÃ¡ng lÃ m viá»‡c)</p>
                                    <p style="margin-bottom: 8px;">â–ª <strong>ê°€ì‚° ì—°ì°¨</strong>: ê·¼ì† 5ë…„ë§ˆë‹¤ +1ì¼</p>
                                    <p style="margin-bottom: 8px;">â–ª <strong>íŠ¹ìˆ˜ í™˜ê²½</strong>: 14~16ì¼ (ìœ í•´/ìœ„í—˜ ì—…ì¢…)</p>
                                    <p style="margin-bottom: 8px;">â–ª <strong>ë¯¸ì‚¬ìš© ì—°ì°¨</strong>: ì´ì›” ë˜ëŠ” ìˆ˜ë‹¹ ì§€ê¸‰ ê°€ëŠ¥</p>
                                </div>
                                <div class="info-box" style="border-color: #4caf50; margin-top: 10px;">
                                    âœ… <strong>ê¸‰ì—¬ ê³„ì‚°</strong>: ì—°ì°¨ 1ì¼ = <strong>8ì‹œê°„ ìœ ê¸‰</strong> (100% ê¸‰ì—¬)
                                </div>
                            </div>

                            <!-- ê²½ì¡°ì‚¬ (Special Leave) -->
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #9c27b0; margin-bottom: 10px;">ğŸ–¤ ê²½ì¡°ì‚¬ íœ´ê°€ (Nghá»‰ viá»‡c riÃªng) - ì œ115ì¡°</h4>
                                <div style="margin-left: 15px;">
                                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 10px;">
                                        <thead>
                                            <tr style="background: #f3e5f5;">
                                                <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">ì‚¬ìœ </th>
                                                <th style="padding: 8px; border: 1px solid #ddd; text-align: center;">ì¼ìˆ˜</th>
                                                <th style="padding: 8px; border: 1px solid #ddd; text-align: center;">ìœ /ë¬´ê¸‰</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td style="padding: 8px; border: 1px solid #ddd;">ë³¸ì¸ ê²°í˜¼</td>
                                                <td style="padding: 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">3ì¼</td>
                                                <td style="padding: 8px; border: 1px solid #ddd; text-align: center; color: #4caf50; font-weight: bold;">ìœ ê¸‰</td>
                                            </tr>
                                            <tr>
                                                <td style="padding: 8px; border: 1px solid #ddd;">ìë…€ ê²°í˜¼</td>
                                                <td style="padding: 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">1ì¼</td>
                                                <td style="padding: 8px; border: 1px solid #ddd; text-align: center; color: #4caf50; font-weight: bold;">ìœ ê¸‰</td>
                                            </tr>
                                            <tr>
                                                <td style="padding: 8px; border: 1px solid #ddd;">ë¶€ëª¨/ë°°ìš°ì/ìë…€ ì‚¬ë§</td>
                                                <td style="padding: 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">3ì¼</td>
                                                <td style="padding: 8px; border: 1px solid #ddd; text-align: center; color: #4caf50; font-weight: bold;">ìœ ê¸‰</td>
                                            </tr>
                                            <tr>
                                                <td style="padding: 8px; border: 1px solid #ddd;">ì¡°ë¶€ëª¨/í˜•ì œìë§¤ ì‚¬ë§</td>
                                                <td style="padding: 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">1ì¼</td>
                                                <td style="padding: 8px; border: 1px solid #ddd; text-align: center; color: #ff9800;">íšŒì‚¬ê·œì •</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="info-box" style="border-color: #9c27b0; margin-top: 10px;">
                                    âœ… <strong>ê¸‰ì—¬ ê³„ì‚°</strong>: ê²½ì¡°ì‚¬ 1ì¼ = <strong>8ì‹œê°„ ìœ ê¸‰</strong> (100% ê¸‰ì—¬)<br>
                                    <span style="color: #999;">â€» ì‹ëŒ€: ê¸°ë³¸ ë¯¸ì§€ê¸‰ (íšŒì‚¬ ì„¤ì •ì—ì„œ ë³€ê²½ ê°€ëŠ¥)</span>
                                </div>
                            </div>

                            <!-- ë³‘ê°€ (Sick Leave) -->
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #ff9800; margin-bottom: 10px;">ğŸ¥ ë³‘ê°€ (Nghá»‰ á»‘m Ä‘au) - ì‚¬íšŒë³´í—˜ë²•</h4>
                                <div style="margin-left: 15px;">
                                    <p style="margin-bottom: 8px;">â–ª <strong>ì§€ê¸‰ ì£¼ì²´</strong>: ì‚¬íšŒë³´í—˜ (BHXH)ì—ì„œ ì§€ê¸‰</p>
                                    <p style="margin-bottom: 8px;">â–ª <strong>ì§€ê¸‰ë¥ </strong>: ê¸‰ì—¬ì˜ <strong>75%</strong> (ìµœëŒ€ 30ì¼/ë…„)</p>
                                    <p style="margin-bottom: 8px;">â–ª <strong>í•„ìš” ì„œë¥˜</strong>: ì˜ì‚¬ ì§„ë‹¨ì„œ (Giáº¥y nghá»‰ á»‘m)</p>
                                </div>
                                <div class="info-box" style="border-color: #ff9800; margin-top: 10px;">
                                    âš ï¸ <strong>ê¸‰ì—¬ ê³„ì‚°</strong>: ë³‘ê°€ = <strong>íšŒì‚¬ ê¸‰ì—¬ì—ì„œ ì œì™¸</strong><br>
                                    <span style="color: #999;">â€» ì‚¬íšŒë³´í—˜ì—ì„œ ë³„ë„ ì§€ê¸‰ (75%) / ì‹ëŒ€: ê¸°ë³¸ ë¯¸ì§€ê¸‰ (íšŒì‚¬ ì„¤ì •ì—ì„œ ë³€ê²½ ê°€ëŠ¥)</span>
                                </div>
                            </div>

                            <!-- ê²°ê·¼ -->
                            <div>
                                <h4 style="color: #607d8b; margin-bottom: 10px;">ğŸ“ ê²°ê·¼ (Váº¯ng máº·t)</h4>
                                <div style="margin-left: 15px;">
                                    <p style="margin-bottom: 8px;">â–ª <strong>ì‚¬ìœ ê²°ê·¼</strong>: ì‚¬ì „ ìŠ¹ì¸ëœ ê°œì¸ ì‚¬ìœ  (ë¬´ê¸‰)</p>
                                    <p style="margin-bottom: 8px;">â–ª <strong>ë¬´ë‹¨ê²°ê·¼</strong>: ë¯¸ìŠ¹ì¸ ê²°ê·¼ (ë¬´ê¸‰ + ì§•ê³„ ê°€ëŠ¥)</p>
                                </div>
                                <div class="info-box" style="border-color: #607d8b; margin-top: 10px;">
                                    âŒ <strong>ê¸‰ì—¬ ê³„ì‚°</strong>: ëª¨ë“  ê²°ê·¼ = <strong>ë¬´ê¸‰</strong> (0ì‹œê°„)
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 8. ì‹¤ìˆ˜ë ¹ì•¡ ê³„ì‚° -->
                    <div class="final-calculation">
                        <h3 style="margin-bottom: 20px; font-size: 1.8em;">ğŸ’µ 8. ì‹¤ìˆ˜ë ¹ì•¡ ê³„ì‚°</h3>
                        <div style="margin-left: 20px; font-size: 1.2em; line-height: 2;">
                            <p style="margin-bottom: 15px; font-size: 1.3em;"><strong>ì‹¤ìˆ˜ë ¹ì•¡</strong> = <strong>ì´ ê¸‰ì—¬</strong></p>
                            <p style="margin-left: 50px; margin-bottom: 10px; font-size: 1.1em;"><span style="color: white; font-weight: bold; font-size: 1.5em;">-</span> ê·¼ë¡œì ë¶€ë‹´ ë³´í—˜ë£Œ (<span id="info-final-emp-total" style="font-weight: bold; font-size: 1.2em;">10.5</span>%)</p>
                            <p style="margin-left: 50px; margin-bottom: 10px; font-size: 1.1em;"><span style="color: white; font-weight: bold; font-size: 1.5em;">-</span> ê°œì¸ì†Œë“ì„¸</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì§ì› ì¶”ê°€/ìˆ˜ì • ëª¨ë‹¬ -->
    <div id="employeeModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; justify-content: center; align-items: center; overflow-y: auto;">
        <div style="background: white; border-radius: 20px; padding: 40px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.3); animation: modalSlideIn 0.3s ease; margin: 20px auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2 id="modalTitle" style="margin: 0; color: #667eea; font-size: 1.8em;">âœ¨ ìƒˆ ì§ì› ì¶”ê°€</h2>
                <button onclick="closeEmployeeModal()" style="background: none; border: none; font-size: 2em; color: #999; cursor: pointer; line-height: 1;">&times;</button>
            </div>

            <div style="display: flex; flex-direction: column; gap: 20px;" onkeypress="if(event.key==='Enter') saveEmployeeFromModal()">
                <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 15px;">
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <label style="font-weight: bold; color: #ff9800; font-size: 1.1em;">ğŸ·ï¸ ì§ì› ì½”ë“œ</label>
                        <input type="text" id="modalEmployeeCode" placeholder="ì˜ˆ: KQ-001" style="padding: 14px 16px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1.1em; transition: all 0.3s; text-transform: uppercase;" onfocus="this.style.borderColor='#ff9800'" onblur="this.style.borderColor='#e0e0e0'">
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <label style="font-weight: bold; color: #667eea; font-size: 1.1em;">ğŸ‘¤ ì§ì› ì´ë¦„ *</label>
                        <input type="text" id="modalEmployeeName" placeholder="ì˜ˆ: Nguyá»…n VÄƒn Nam" style="padding: 14px 16px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1.1em; transition: all 0.3s;" onfocus="this.style.borderColor='#667eea'" onblur="this.style.borderColor='#e0e0e0'">
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <label style="font-weight: bold; color: #667eea; font-size: 1.1em;">ğŸ‚ ìƒë…„ì›”ì¼</label>
                        <input type="date" id="modalBirthDate" style="padding: 14px 16px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1.1em; transition: all 0.3s;" onfocus="this.style.borderColor='#667eea'" onblur="this.style.borderColor='#e0e0e0'">
                    </div>

                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <label style="font-weight: bold; color: #667eea; font-size: 1.1em;">ğŸ“… ì…ì‚¬ì¼</label>
                        <input type="date" id="modalHireDate" style="padding: 14px 16px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1.1em; transition: all 0.3s;" onfocus="this.style.borderColor='#667eea'" onblur="this.style.borderColor='#e0e0e0'">
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <label style="font-weight: bold; color: #667eea; font-size: 1.1em;">ğŸ¢ ë¶€ì„œ</label>
                        <input type="text" id="modalDepartment" placeholder="ì˜ˆ: Production, Office" style="padding: 14px 16px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1.1em; transition: all 0.3s;" onfocus="this.style.borderColor='#667eea'" onblur="this.style.borderColor='#e0e0e0'">
                    </div>

                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <label style="font-weight: bold; color: #667eea; font-size: 1.1em;">ğŸ’¼ ì§ì±…</label>
                        <input type="text" id="modalPosition" placeholder="ì˜ˆ: Worker, Admin" style="padding: 14px 16px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1.1em; transition: all 0.3s;" onfocus="this.style.borderColor='#667eea'" onblur="this.style.borderColor='#e0e0e0'">
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <label style="font-weight: bold; color: #667eea; font-size: 1.1em;">ğŸ’° ê¸°ë³¸ê¸‰ (Ä‘)</label>
                        <input type="number" id="modalBasicSalary" placeholder="6,980,000" value="6980000" style="padding: 14px 16px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1.1em; transition: all 0.3s;" onfocus="this.style.borderColor='#667eea'" onblur="this.style.borderColor='#e0e0e0'">
                    </div>

                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <label style="font-weight: bold; color: #667eea; font-size: 1.1em;">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ë¶€ì–‘ê°€ì¡± (ëª…)</label>
                        <input type="number" id="modalDependents" value="0" min="0" style="padding: 14px 16px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1.1em; transition: all 0.3s;" onfocus="this.style.borderColor='#667eea'" onblur="this.style.borderColor='#e0e0e0'">
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <label style="font-weight: bold; color: #667eea; font-size: 1.1em;">ğŸŒ´ ì—°ì°¨ ë°œìƒ (ì¼/ë…„)</label>
                        <input type="number" id="modalAnnualLeavePerYear" value="12" min="0" style="padding: 14px 16px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1.1em; transition: all 0.3s;" onfocus="this.style.borderColor='#667eea'" onblur="this.style.borderColor='#e0e0e0'">
                    </div>

                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <label style="font-weight: bold; color: #ff9800; font-size: 1.1em;">ğŸ“Š ì—°ì°¨ ì¡°ì • (ì¼)</label>
                        <input type="number" id="modalAnnualLeaveAdjustment" value="0" placeholder="-6 ë˜ëŠ” +1" style="padding: 14px 16px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1.1em; transition: all 0.3s;" onfocus="this.style.borderColor='#ff9800'" onblur="this.style.borderColor='#e0e0e0'">
                    </div>
                </div>

                <div style="background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); padding: 15px; border-radius: 10px; border-left: 4px solid #ff9800;">
                    <p style="margin: 0; color: #f57c00; font-size: 0.95em; line-height: 1.6;">
                        ğŸ’¡ <strong>ì—°ì°¨ ì¡°ì •:</strong><br>
                        â€¢ <strong>ìŒìˆ˜</strong> (ì˜ˆ: -6) = ì´ë¯¸ 6ì¼ ì‚¬ìš©<br>
                        â€¢ <strong>ì–‘ìˆ˜</strong> (ì˜ˆ: +1) = ë³´ë„ˆìŠ¤ 1ì¼ ì¶”ê°€ ì§€ê¸‰
                    </p>
                </div>

                <!-- ì‚¬íšŒë³´í—˜ ë¯¸ê°€ì… ì²´í¬ë°•ìŠ¤ -->
                <div style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); padding: 20px; border-radius: 10px; border-left: 4px solid #2196f3; margin-top: 15px;">
                    <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; user-select: none;">
                        <input type="checkbox" id="modalInsuranceExempt" style="width: 24px; height: 24px; cursor: pointer; accent-color: #2196f3;">
                        <span style="font-weight: bold; color: #1976d2; font-size: 1.1em;">ğŸ¥ ì‚¬íšŒë³´í—˜ ë¯¸ê°€ì…ì</span>
                    </label>
                    <p style="margin: 10px 0 0 36px; color: #0277bd; font-size: 0.95em; line-height: 1.6;">
                        ğŸ’¡ ì²´í¬ ì‹œ BHXH, BHYT, BHTN, ë…¸ì¡°ë¹„ê°€ ê³µì œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤<br>
                        (ì¼ìš©ì§, ë‹¨ê¸° ê³„ì•½ì§ ë“±ì— ì ìš©)
                    </p>
                </div>
            </div>

            <div style="display: flex; gap: 15px; margin-top: 30px;">
                <button onclick="closeEmployeeModal()" style="flex: 1; padding: 14px; background: #f5f5f5; color: #666; border: none; border-radius: 10px; font-size: 1.1em; font-weight: bold; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#e0e0e0'" onmouseout="this.style.background='#f5f5f5'">
                    ì·¨ì†Œ
                </button>
                <button id="modalSaveBtn" onclick="saveEmployeeFromModal()" style="flex: 2; padding: 14px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 10px; font-size: 1.1em; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.4)'">
                    âœ… ì €ì¥
                </button>
            </div>
        </div>
    </div>

    <!-- ì§ì› ìƒì„¸ë³´ê¸° ëª¨ë‹¬ -->
    <div id="employeeDetailModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; justify-content: center; align-items: center; overflow-y: auto;">
        <div style="background: white; border-radius: 20px; padding: 40px; width: 90%; max-width: 600px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); animation: modalSlideIn 0.3s ease; margin: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2 style="margin: 0; color: #00bcd4; font-size: 1.8em;">ğŸ‘ï¸ ì§ì› ìƒì„¸ ì •ë³´</h2>
                <button onclick="closeEmployeeDetailModal()" style="background: none; border: none; font-size: 2em; color: #999; cursor: pointer; line-height: 1;">&times;</button>
            </div>

            <div id="employeeDetailContent" style="display: flex; flex-direction: column; gap: 20px;">
                <!-- ì—¬ê¸°ì— ì§ì› ìƒì„¸ ì •ë³´ê°€ ë™ì ìœ¼ë¡œ ë“¤ì–´ê° -->
            </div>

            <div style="margin-top: 30px;">
                <button onclick="closeEmployeeDetailModal()" style="width: 100%; padding: 14px; background: linear-gradient(135deg, #00bcd4 0%, #0097a7 100%); color: white; border: none; border-radius: 10px; font-size: 1.1em; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(0, 188, 212, 0.4); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(0, 188, 212, 0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0, 188, 212, 0.4)'">
                    ë‹«ê¸°
                </button>
            </div>
        </div>
    </div>

    <style>
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
    </style>

    <!-- ìˆ˜ë‹¹ ì¶”ê°€/ìˆ˜ì • ëª¨ë‹¬ -->
    <div id="allowanceModal" onclick="if(event.target === this) closeAllowanceModal()" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); justify-content: center; align-items: center; overflow-y: auto;">
        <div style="background: white; border-radius: 20px; width: 90%; max-width: 600px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); margin: 20px auto; max-height: 90vh; overflow-y: auto;">
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px 30px; border-radius: 20px 20px 0 0; display: flex; justify-content: space-between; align-items: center;">
                <h2 id="allowanceModalTitle" style="font-size: 1.8em; margin: 0;">â• ìˆ˜ë‹¹ ì¶”ê°€</h2>
                <button onclick="closeAllowanceModal()" style="background: rgba(255,255,255,0.2); border: none; color: white; font-size: 1.5em; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; transition: all 0.3s;">âœ•</button>
            </div>

            <div style="padding: 30px;">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">ìˆ˜ë‹¹ ì´ë¦„</label>
                    <input type="text" id="allowanceName" placeholder="ì˜ˆ: ê°œê·¼ìˆ˜ë‹¹, êµí†µë¹„, ìœ„í—˜ìˆ˜ë‹¹" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                </div>

                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">ê¸ˆì•¡ (Ä‘)</label>
                    <input type="number" id="allowanceAmount" placeholder="300000" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                </div>

                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">ë¬´ë‹¨ê²°ê·¼ ì‹œ ì§€ê¸‰ ê·œì¹™</label>
                    <select id="allowanceOnAbsence" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; cursor: pointer;">
                        <option value="zero">âŒ ì§€ê¸‰ ì•ˆ í•¨ (0ì›)</option>
                        <option value="proportional">ğŸ“Š ë¹„ìœ¨ë¡œ ì§€ê¸‰ (ê·¼ë¬´ì¼ ê¸°ì¤€)</option>
                        <option value="full">âœ… ì „ì•¡ ì§€ê¸‰</option>
                    </select>
                    <small style="color: #999; display: block; margin-top: 5px;">ë¬´ë‹¨ê²°ê·¼ì´ ìˆì„ ë•Œ ì´ ìˆ˜ë‹¹ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í• ì§€ ì„ íƒ</small>
                </div>

                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">ì‚¬ìœ ê²°ê·¼ ì‹œ ì§€ê¸‰ ê·œì¹™</label>
                    <select id="allowanceOnExcusedAbsence" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; cursor: pointer;">
                        <option value="zero">âŒ ì§€ê¸‰ ì•ˆ í•¨ (0ì›)</option>
                        <option value="proportional">ğŸ“Š ë¹„ìœ¨ë¡œ ì§€ê¸‰ (ê·¼ë¬´ì¼ ê¸°ì¤€)</option>
                        <option value="full">âœ… ì „ì•¡ ì§€ê¸‰</option>
                    </select>
                    <small style="color: #999; display: block; margin-top: 5px;">ì‚¬ìœ ê²°ê·¼(ë¬´ê¸‰íœ´ê°€)ì´ ìˆì„ ë•Œ ì´ ìˆ˜ë‹¹ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í• ì§€ ì„ íƒ</small>
                </div>

                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">ì—°ì°¨ ì‚¬ìš© ì‹œ ì§€ê¸‰ ê·œì¹™</label>
                    <select id="allowanceOnAnnualLeave" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; cursor: pointer;">
                        <option value="zero">âŒ ì§€ê¸‰ ì•ˆ í•¨ (0ì›)</option>
                        <option value="proportional">ğŸ“Š ë¹„ìœ¨ë¡œ ì§€ê¸‰ (ê·¼ë¬´ì¼ ê¸°ì¤€)</option>
                        <option value="full">âœ… ì „ì•¡ ì§€ê¸‰</option>
                    </select>
                    <small style="color: #999; display: block; margin-top: 5px;">ì—°ì°¨ë¥¼ ì‚¬ìš©í–ˆì„ ë•Œ ì´ ìˆ˜ë‹¹ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í• ì§€ ì„ íƒ</small>
                </div>

                <div style="margin-bottom: 20px;">
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" id="allowanceEnabled" checked style="width: 20px; height: 20px; margin-right: 10px; cursor: pointer;">
                        <span style="font-weight: bold;">í™œì„±í™” (ê¸‰ì—¬ ê³„ì‚° ì‹œ ì ìš©)</span>
                    </label>
                </div>

                <div style="margin-bottom: 20px; padding: 15px; background: #fff3cd; border-left: 4px solid #ff9800; border-radius: 8px;">
                    <label style="display: flex; align-items: center; cursor: pointer; margin-bottom: 10px;">
                        <input type="checkbox" id="allowanceIsTaxable" checked style="width: 20px; height: 20px; margin-right: 10px; cursor: pointer;">
                        <span style="font-weight: bold; color: #333;">âš–ï¸ ê³¼ì„¸ ëŒ€ìƒ ìˆ˜ë‹¹ (ì¼ë°˜ì ìœ¼ë¡œ ì²´í¬ ìœ ì§€)</span>
                    </label>
                    <small style="color: #666; display: block; line-height: 1.5;">
                        â€» ëŒ€ë¶€ë¶„ì˜ ìˆ˜ë‹¹ì€ ê³¼ì„¸ ëŒ€ìƒì…ë‹ˆë‹¤. ë² íŠ¸ë‚¨ ì„¸ë²•ìƒ ë²•ì  ê·¼ê±°ê°€ í™•ì‹¤í•œ ê²½ìš°ì—ë§Œ ì²´í¬ë¥¼ í•´ì œí•˜ì„¸ìš”.<br>
                        â€» íŠ¹ìˆ˜ìˆ˜ë‹¹(Phá»¥ cáº¥p Ä‘áº·c biá»‡t)ì€ ê³¼ì„¸ ì²˜ë¦¬ê°€ ì•ˆì „í•©ë‹ˆë‹¤.
                    </small>
                </div>

                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">ìˆ˜ë‹¹ ì„¤ëª… (ì„ íƒì‚¬í•­)</label>
                    <textarea id="allowanceDescription" rows="3" placeholder="ì˜ˆ: ì—…ë¬´ ì„±ê²©, ì±…ì„ ë° ì§ì›ì˜ ê¸°ì—¬ë„ì— ë”°ë¼ ì§€ê¸‰" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; font-family: inherit; resize: vertical;"></textarea>
                    <small style="color: #999; display: block; margin-top: 5px;">ìˆ˜ë‹¹ì˜ ì§€ê¸‰ ëª©ì ì´ë‚˜ ì¡°ê±´ì„ ëª…ì‹œí•˜ë©´ ì„¸ë¬´ ì¡°ì‚¬ ì‹œ ìœ ë¦¬í•©ë‹ˆë‹¤.</small>
                </div>
            </div>

            <div style="padding: 20px 30px; background: #f8f9fa; display: flex; justify-content: flex-end; gap: 10px; border-radius: 0 0 20px 20px;">
                <button onclick="closeAllowanceModal()" style="padding: 12px 30px; background: #ddd; color: #666; border: none; border-radius: 8px; font-size: 1.1em; font-weight: bold; cursor: pointer;">ì·¨ì†Œ</button>
                <button onclick="saveAllowance()" style="padding: 12px 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 1.1em; font-weight: bold; cursor: pointer;">ì €ì¥</button>
            </div>
        </div>
    </div>

    <script>
        // Load and display company profile
        function loadCompanyProfile() {
            const currentCompanyId = localStorage.getItem('currentCompanyId');
            const companyProfiles = JSON.parse(localStorage.getItem('companyProfiles') || '{}');

            const companyHeaderDiv = document.getElementById('companyHeader');

            if (currentCompanyId && companyProfiles[currentCompanyId]) {
                const company = companyProfiles[currentCompanyId];

                // Build company header HTML
                let headerHTML = '';

                if (company.logo) {
                    headerHTML += `<img src="${company.logo}" alt="${company.name}" class="company-logo">`;
                }

                headerHTML += `
                    <div class="company-info">
                        <div class="company-name">${company.name}</div>
                        ${company.address ? `<div class="company-address">ğŸ“ ${company.address}</div>` : ''}
                    </div>
                `;

                companyHeaderDiv.innerHTML = headerHTML;

                // Apply company color theme
                if (company.color) {
                    const style = document.createElement('style');
                    style.textContent = `
                        body {
                            background: linear-gradient(135deg, ${company.color} 0%, #764ba2 100%) !important;
                        }
                        .header h1 {
                            color: ${company.color} !important;
                        }
                    `;
                    document.head.appendChild(style);
                }
            }
        }

        // Load company profile on page load
        document.addEventListener('DOMContentLoaded', loadCompanyProfile);
    </script>

</body>
</html>
